(this.webpackJsonpmain=this.webpackJsonpmain||[]).push([[0],{13:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(6),i=n.n(a),o=n(2),s=n.n(o),u=n(3),d=n(4),p=window.require("electron"),l=p.desktopCapturer,f=p.ipcRenderer;function h(){return j.apply(this,arguments)}function j(){return(j=Object(u.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getSources({types:["screen"]});case 2:return t=e.sent,e.next=5,navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t[0].id,maxWidth:1920,maxHeight:1080}}});case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b=new window.RTCPeerConnection({});b.ondatachannel=function(e){e.channel.onmessage=function(e){var t=JSON.parse(e.data),n=t.type,r=t.data;"mouse"===n&&(r.screen={width:window.screen.width,height:window.screen.height}),f.send("robot",n,r)}},b.onicecandidate=function(e){var t=e.candidate;e.candidate&&f.send("forward","puppet-candidate",{candidate:t.candidate,sdpMid:t.sdpMid,sdpMLineIndex:t.sdpMLineIndex})};var x=[];function v(e){return w.apply(this,arguments)}function w(){return(w=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&x.push(t),!b.remoteDescription||!b.remoteDescription.type){e.next=10;break}n=0;case 3:if(!(n<x.length)){e.next=10;break}return console.log(x[n]),e.next=7,b.addIceCandidate(new RTCIceCandidate(x[n]));case 7:n++,e.next=3;break;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){return m.apply(this,arguments)}function m(){return(m=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:return n=e.sent,b.addStream(n),e.next=6,b.setRemoteDescription(t);case 6:return e.t0=b,e.next=9,b.createAnswer();case 9:return e.t1=e.sent,e.next=12,e.t0.setLocalDescription.call(e.t0,e.t1);case 12:return e.abrupt("return",b.localDescription);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}f.on("candidate",(function(e,t){v(t)})),f.on("offer",function(){var e=Object(u.a)(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(n);case 2:return r=e.sent,f.send("forward","answer",{type:r.type,sdp:r.sdp}),e.next=6,v();case 6:x=[];case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),f.on("exit-be-controlled",(function(){(b=new window.RTCPeerConnection({})).ondatachannel=function(e){e.channel.onmessage=function(e){var t=JSON.parse(e.data),n=t.type,r=t.data;"mouse"===n&&(r.screen={width:window.screen.width,height:window.screen.height}),f.send("robot",n,r)}}}));var y=n(0),g=window.require("electron").ipcRenderer;var k=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),i=Object(d.a)(a,2),o=i[0],p=i[1],l=Object(r.useState)(""),f=Object(d.a)(l,2),h=f[0],j=f[1],b=Object(r.useState)(""),x=Object(d.a)(b,2),v=x[0],w=x[1],O=Object(r.useState)(1),m=Object(d.a)(O,2),k=m[0],C=m[1],S=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.invoke("login");case 2:t=e.sent,p(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(e,t,n){1===n?j("\u6b63\u5728\u8fdc\u7a0b\u63a7\u5236".concat(t)):0===n?j("\u6b63\u5728\u88ab".concat(t,"\u63a7\u5236")):2===n&&j("")},D=function(e,t){w(t)};return Object(r.useEffect)((function(){return S(),g.on("control-state-change",M),g.on("error",D),function(){g.removeListener("control-state-change",M),g.removeListener("error",D)}}),[]),Object(r.useEffect)((function(){g.send("set-ratio",k)}),[k]),Object(y.jsx)("div",{className:"App",style:{position:"absolute",top:"30%",left:"50%",transform:"translate(-50%, -50%)"},children:""===h?Object(y.jsxs)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column"},children:[Object(y.jsxs)("h3",{style:{textAlign:"center"},children:["\u4f60\u7684\u72b6\u6001\u7801:",Object(y.jsx)("span",{onContextMenu:function(e){return e.preventDefault(),void g.send("copy-popup")},children:o})]}),Object(y.jsxs)("div",{children:[Object(y.jsx)("label",{htmlFor:"setRatio",children:"\u8bbe\u7f6e\u5c4f\u5e55\u7f29\u653e\u6bd4"}),Object(y.jsxs)("select",{id:"setRatio",onChange:function(e){return function(e){C(Number(e.target.value))}(e)},defaultValue:k.toString(),children:[Object(y.jsx)("option",{value:"1",selected:1===k,children:"1"}),Object(y.jsx)("option",{value:"1.25",selected:1.25===k,children:"1.25"}),Object(y.jsx)("option",{value:"1.5",selected:1.5===k,children:"1.5"})]}),Object(y.jsx)("button",{onClick:function(){return S()},children:"\u5237\u65b0\u72b6\u6001\u7801"})]}),Object(y.jsx)("input",{type:"text",value:n,onChange:function(e){c(e.target.value)}}),Object(y.jsx)("button",{onClick:function(){return function(e){g.send("control",e)}(n)},children:"\u786e\u8ba4\u8fde\u63a5"}),v&&Object(y.jsx)("p",{children:v})]}):Object(y.jsxs)("div",{children:[Object(y.jsx)("h3",{children:h}),Object(y.jsxs)("h5",{children:["\u4f60\u7684\u72b6\u6001\u7801:",o]}),Object(y.jsx)("button",{onClick:function(e){g.send("exit-control")},children:"\u9000\u51fa\u8fde\u63a5"})]})})};i.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(k,{})}),document.getElementById("root"))}},[[13,1,2]]]);
//# sourceMappingURL=main.dc66374c.chunk.js.map